<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>WebSocket Client Sample</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
  </head>
  <body class="bg-gray-50">
    <header class="bg-gradient-to-r from-blue-600 to-blue-800 text-white py-8 sm:py-16">
      <div class="container mx-auto text-center px-4">
        <div class="text-2xl sm:text-4xl font-bold mb-4">
          <i class="fas fa-bolt"></i> WebSocket Client Sample
        </div>
        <p class="text-lg sm:text-xl max-w-2xl mx-auto">
          Contoh client WebSocket untuk menguji koneksi dan broadcast pesan dari server
        </p>
      </div>
    </header>
    <div class="container mx-auto px-4 py-8 sm:py-12">
      <div class="bg-white rounded-xl shadow-lg p-6 sm:p-8 max-w-2xl mx-auto">
        <div class="flex flex-col sm:flex-row gap-4 mb-6"></div>
          <button
            id="connectBtn"
            class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded transition"
          >
            <i class="fas fa-plug mr-2"></i> Connect WebSocket
          </button>
          <button
            id="sendBtn"
            class="flex-1 bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded transition"
          >
            <i class="fas fa-paper-plane mr-2"></i> Send Test Broadcast
          </button>
        </div>
        <div>
          <h2 class="text-lg font-semibold mb-2"><i class="fas fa-terminal mr-2"></i>Log</h2>
          <pre
            id="log"
            class="bg-gray-900 text-green-400 rounded-lg p-4 h-64 overflow-y-auto text-sm"
          ></pre>
        </div>
      </div>
    </div>
    <footer class="bg-gray-900 text-white py-6 sm:py-8 mt-8 sm:mt-12">
      <div class="container mx-auto px-4 text-center">
        <p class="text-sm sm:text-base">
          Â© 2025 Express TypeScript Template by Arghoritma.
        </p>
        <div class="mt-3 sm:mt-4 space-x-4">
          <a
            href="https://github.com/arghoritma/apilite"
            class="text-gray-400 hover:text-white text-sm sm:text-base"
          >
            <i class="fab fa-github"></i> GitHub
          </a>
          <a
            href="/#documentation"
            class="text-gray-400 hover:text-white text-sm sm:text-base"
          >
            <i class="fas fa-book"></i> Documentation
          </a>
          <a
            href="/#support"
            class="text-gray-400 hover:text-white text-sm sm:text-base"
          >
            <i class="fas fa-headset"></i> Support
          </a>
        </div>
      </div>
    </footer>
    <script>
      let ws;
      const log = (msg) => {
        const logEl = document.getElementById("log");
        logEl.textContent += msg + "\n";
        logEl.scrollTop = logEl.scrollHeight;
      };
      document.getElementById("connectBtn").onclick = () => {
        ws = new WebSocket(`ws://${location.host}/ws`);
        ws.onopen = () => log("WebSocket connected");
        ws.onmessage = (e) => log("Received: " + e.data);
        ws.onclose = () => log("WebSocket closed");
        ws.onerror = (e) => log("WebSocket error: " + (e.message || e.type));
      };
      document.getElementById("sendBtn").onclick = async () => {
        await fetch("/api/ws/broadcast", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            type: "test",
            payload: { msg: "Hello from HTTP!" },
          }),
        });
        log("Broadcast sent via HTTP endpoint");
      };
    </script>
  </body>
</html>
